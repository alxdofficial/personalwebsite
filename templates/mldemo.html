
<!DOCTYPE html><!--  This site was created in Webflow. https://www.webflow.com  -->
<!--  Last Published: Thu Aug 25 2022 04:51:28 GMT+0000 (Coordinated Universal Time)  -->
<html data-wf-page="6306e988cfd3b0e00bb4076d" data-wf-site="62f0a9bcac1acae2293389f6">
<head>
  <meta charset="utf-8">
  <title>mldemo</title>
  <meta content="mldemo" property="og:title">
  <meta content="mldemo" property="twitter:title">
  <meta content="width=device-width, initial-scale=1" name="viewport">
  <meta content="Webflow" name="generator">
  <link href="/static/css/normalize.css" rel="stylesheet" type="text/css">
  <link href="/static/css/webflow.css" rel="stylesheet" type="text/css">
  <link href="/static/css/personal-website-e88243.webflow.css" rel="stylesheet" type="text/css">
  <!-- [if lt IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv.min.js" type="text/javascript"></script><![endif] -->
  <script type="text/javascript">!function(o,c){var n=c.documentElement,t=" w-mod-";n.className+=t+"js",("ontouchstart"in o||o.DocumentTouch&&c instanceof DocumentTouch)&&(n.className+=t+"touch")}(window,document);</script>
  <link href="/static/images/favicon.ico" rel="shortcut icon" type="image/x-icon">
  <link href="/static/images/webclip.png" rel="apple-touch-icon">
  <script src="https://code.jquery.com/jquery-3.3.1.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.5.0/socket.io.js"></script>
</head>
<body class="body-3">
  <div class="div-block-13">
    <div class="description-heading">AI guesses fashion style of clothes</div>
  </div>
  <div class="description-div">
    <div class="description-text">A while back I programmed a fashion machine learning algorithm for a school project. It takes 14 inputs of various attributes of a garment, and classified them into three styles: rustic, urban, and minimalist. I manually labeled 100+ items into the above categories, and trained a machine learning model to use naive bayes for classification. Due to school requirements, this program was written in java using the Weka framework. The backend server runs an Jar instance, and the python backend running this web app communicates with it through IPC sockets.<br><br>Before you go ahead and try it out, it is important to note that this machine learning algorithm is designed to work with “double standards”. For example, when we input the thickness attribute of a garment, we aren’t measuring an absolute thickness using a caliper. We label a sweater as relatively “warm” compared to a T-shirt, but we label a raincoat as “cool” compared to a winter parka, even though the raincoat may physically be warmer than a sweater. We are labeling based on a sentimental comparison to other garments in its genre, instead of absolute parameters. </div>
  </div>
  <div class="ml-formblock w-form">
    <form id="mlForm" name="wf-form-mlForm" data-name="mlForm" method="get" class="ml-form">
    <div class="mlform-div1">
      <div class="mlform-div"><input type="text" class="mlform-text-small w-input" maxlength="256" name="name" data-name="name" placeholder="Item Name" id="name" required=""><select id="color" name="color" data-name="color" class="select-field w-select">
          <option value="black">Color</option>
          <option value="black">Black</option>
          <option value="beige">Beige</option>
          <option value="blue">Blue</option>
          <option value="white">White</option>
          <option value="pink">Pink</option>
          <option value="red">Red</option>
          <option value="grey">Grey</option>
          <option value="yellow">Yellow</option>
          <option value="green">Green</option>
        </select><select id="length" name="length" data-name="length" class="select-field-copy3 w-select">
          <option value="short">Length</option>
          <option value="short">Short</option>
          <option value="mid">Mid</option>
          <option value="long">Long</option>
        </select><select id="thickness" name="thickness" data-name="thickness" class="select-field-copy1 w-select">
          <option value="thin">Thickness</option>
          <option value="thin">Thin</option>
          <option value="mid">Mid</option>
          <option value="thick">Thick</option>
        </select><select id="warmth" name="warmth" data-name="warmth" class="select-field-copy3 w-select">
          <option value="low">Warmth</option>
          <option value="low">Low</option>
          <option value="mid">Mid</option>
          <option value="high">High</option>
        </select></div>
      <div class="mlform-div"><select id="Fabric-Stich-Density" name="Fabric-Stich-Density" data-name="Fabric Stich Density" class="select-field-copy2 w-select">
          <option value="low">Fabric Stich Density</option>
          <option value="low">Low</option>
          <option value="mid">Mid</option>
          <option value="high">High</option>
        </select><select id="shiny" name="shiny" data-name="shiny" class="select-field-copy3 w-select">
          <option value="yes">shiny</option>
          <option value="yes">Yes</option>
          <option value="no">No</option>
        </select><select id="body-contour" name="body-contour" data-name="body-contour" class="select-field-copy3 w-select">
          <option value="flowy">Body Contour</option>
          <option value="flowy">Flowy</option>
          <option value="box">Box</option>
          <option value="hourglass">Hourglass</option>
        </select><input type="number" class="mlform-text-small w-input" maxlength="256" name="numcolors" data-name="numcolors" placeholder="Number of Colors" id="numcolors" required=""><select id="stiffness" name="stiffness" data-name="stiffness" class="select-field w-select">
          <option value="stretch">Stiffness</option>
          <option value="stretch">Stretch</option>
          <option value="mid">Mid</option>
          <option value="stiff">Stiff</option>
        </select></div>
      <div class="mlform-div-copy"><select id="water-resistance" name="water-resistance" data-name="water-resistance" class="select-field-copy4 w-select">
          <option value="yes">Water Resistance</option>
          <option value="yes">Yes</option>
          <option value="no">No</option>
        </select><select id="material" name="material" data-name="material" class="select-field-copy1 w-select">
          <option value="cotton">Material</option>
          <option value="cotton">Cotton</option>
          <option value="wool">Wool</option>
          <option value="synthetic">Synthetic</option>
          <option value="denim">Denim</option>
        </select><select id="fit" name="fit" data-name="fit" class="select-field-copy1 w-select">
          <option value="loose">Fit</option>
          <option value="loose">Loose</option>
          <option value="mid">Mid</option>
          <option value="tight">Tight</option>
        </select><select id="pattern" name="pattern" data-name="pattern" class="select-field-copy3 w-select">
          <option value="solid">Pattern</option>
          <option value="solid">Solid</option>
          <option value="lines">Lines</option>
          <option value="faded">Faded (gradient)</option>
          <option value="grid">grid</option>
          <option value="floral">floral</option>
          <option value="graphics">graphics</option>
        </select><select id="contrast" name="contrast" data-name="contrast" class="select-field-copy3 w-select">
          <option value="low">Contrast</option>
          <option value="low">low</option>
          <option value="high">high</option>
        </select></div>
    </div>
    <div class="ml-div4">
        <input type="submit" data-wait="Please wait..." value="Send to ML Algorithm" class="submit-button w-button">
    </div>
    </form>
  </div>

  <div class="mldemo-result-div-outer">
    <div class="ml-result-inner">
      <div class="ml-result-bg"></div>
      <div class="ml-result-heading">The AI thinks your cloth&#x27;s style is</div>
      <div class="div-block-14">
        <div class="text-block-13" id="mlresult">ML Result</div>
      </div>
    </div>
  </div>

  <script>
        const socket = io()
        socket.on('connect', function() {
            console.log('socket connected')
        })

         document.forms['mlForm'].onsubmit = function(){
            console.log('client: form submitted')
            var inputasstring = document.getElementById('name').value + "," + document.getElementById('color').value + ","
             + document.getElementById('length').value + ","+ document.getElementById('thickness').value + ","+ document.getElementById('warmth').value + ","
             + document.getElementById('Fabric-Stich-Density').value + ","+ document.getElementById('shiny').value + ","+ document.getElementById('numcolors').value + ","
             + document.getElementById('body-contour').value + ","+ document.getElementById('stiffness').value + ","+ document.getElementById('water-resistance').value + ","
             + document.getElementById('material').value + ","+ document.getElementById('fit').value + ","+ document.getElementById('pattern').value + ","
             + document.getElementById('contrast').value
            console.log(inputasstring)
            socket.emit('form-submit',{'inputasstring':inputasstring})
        }

        socket.on('show-ml-result', function (json) {
            document.getElementById('mlresult').innerHTML = json.result
        })
    </script>

  <div class="description-div">
    <div class="description-heading">Machine Learning with Weka</div>
    <div class="description-text">Due to school requirements, I had to write this program in java, and the best ML framework for java was Weka. Weka takes a data sheet file called an .arff file. The columns of the data are declared at the top of the page, and each data entry is a comma delimited line of the various parameters. Take a look at a snippet of the arff file used in this demo.</div>
    <a href="#" class="enlargable-image w-inline-block w-lightbox"><img src="/static/images/sample-arff-file.png" loading="lazy" srcset="/static/images/sample-arff-file.png 500w, /static/images/sample-arff-file.png 800w" sizes="(max-width: 479px) 90vw, (max-width: 767px) 70vw, (max-width: 991px) 50vw, 40vw" alt="" class="image-4">
      <script type="application/json" class="w-json">{
  "items": [
    {
      "_id": "example_img",
      "origFileName": "sample arff file.png",
      "fileName": "sample arff file.png",
      "fileSize": 150326,
      "height": 858,
      "url": "/static/images/sample-arff-file.png",
      "width": 1047,
      "type": "image"
    }
  ],
  "group": ""
}</script>
    </a>
    <div class="description-text">The chosen algorithm for model training is naive bayes. Essentially, naive bayes work the same as conditional probability. If we write the definition of conditional probability altered using some simple algebra, we get the definition of bayes theorem.</div>
    <a href="#" class="enlargable-image w-inline-block w-lightbox"><img src="/static/images/ml-diagram1.png" loading="lazy" srcset="/static/images/ml-diagram1.png 500w, /static/images/ml-diagram1.png 800w" sizes="(max-width: 479px) 90vw, (max-width: 767px) 70vw, (max-width: 991px) 50vw, 40vw" alt="" class="image-4">
      <script type="application/json" class="w-json">{
  "items": [
    {
      "_id": "example_img",
      "origFileName": "ml diagram1.png",
      "fileName": "ml diagram1.png",
      "fileSize": 82493,
      "height": 540,
      "url": "/static/images/ml-diagram1.png",
      "width": 1060,
      "type": "image"
    }
  ],
  "group": ""
}</script>
    </a>
    <div class="description-text">Now let&#x27;s think about this equation in our problem domain. As an example, we want to know what’s the probability of a garment being “rustic” provided that it is red, thick, densely stitched, made of wool, and not waterproof… We can rephrase this in terms of a conditional probability, where C1 is the classification “rustic”, and A1,A2,A3… are the different attributes. Now we are basically asking, what is P(C1|A). In naive bayes, the word naive means that each attribute is not dependent on each other. But in reality, even many systems that have inter-dependent attributes, can still enjoy a decently accurate naive bayes classification. Using our derived equations below, we simply calculate the probability using C1, then repeat using C2 and then C3. In the end, we just take the biggest result and use that to label our item.</div>
    <a href="#" class="enlargable-image w-inline-block w-lightbox"><img src="/static/images/ml-diagram3.png" loading="lazy" srcset="/static/images/ml-diagram3.png 500w, /static/images/ml-diagram3.png 800w, /static/images/ml-diagram3.png 1080w, /static/images/ml-diagram3.png 1600w" sizes="(max-width: 479px) 90vw, (max-width: 767px) 70vw, (max-width: 991px) 50vw, 40vw" alt="" class="image-4">
      <script type="application/json" class="w-json">{
  "items": [
    {
      "_id": "example_img",
      "origFileName": "ml diagram3.png",
      "fileName": "ml diagram3.png",
      "fileSize": 211313,
      "height": 937,
      "url": "/static/images/ml-diagram3.png",
      "width": 1615,
      "type": "image"
    }
  ],
  "group": ""
}</script>
    </a>
    <div class="description-text">Finally, it helps to have a visual representation of what we just did. Consider the set of all attributes, A0 through An. We can lay them down on this rectangle, and then we can draw curves to encircle the attributes. These curves represent the possible classifications, C1, C2, and C3. C1 encircles a bigger area of A2 than C2, representing that A2 being true makes a big contribution in the probability of C1 being true, but not much for C2 or C3. C1 doesn&#x27;t cover any ground in A12, meaning that A12 being true or false makes negligible difference in the probability of A1. In the end, we are just asking which intersection between a classification and the set of all attributes gives us the best bang for our buck.</div>
    <a href="#" class="enlargable-image w-inline-block w-lightbox"><img src="/static/images/ml-diagram2.png" loading="lazy" srcset="/static/images/ml-diagram2.png 500w, /static/images/ml-diagram2.png 800w, /static/images/ml-diagram2.png 1080w" sizes="(max-width: 479px) 90vw, (max-width: 991px) 80vw, 60vw" alt="" class="image-4-copy">
      <script type="application/json" class="w-json">{
  "items": [
    {
      "_id": "example_img",
      "origFileName": "ml diagram2.png",
      "fileName": "ml diagram2.png",
      "fileSize": 196378,
      "height": 592,
      "url": "/static/images/ml-diagram2.png",
      "width": 1281,
      "type": "image"
    }
  ],
  "group": ""
}</script>
    </a>
    <div class="description-heading">How IPC sockets were used</div>
    <div class="description-text">The java application has a TCP server using the java.net and .io modules. I specified an ephemeral port, or a port that has such a high number that it typically isn&#x27;t assigned to any applications. Since the server is linux, I simply export the java project as a .jar file, and run it as a system service on Ubuntu. The python backend running this website parses requests into bytes with a maximum length of 1024 bytes. Then it sends the message to the java socket server, who decodes the message in ASCII. Note that I programmed in special character sequences like “#end” and “#quit” to mark the end of the transmission. The java socket server is threaded and will respond with the results of the Weka analysis when ready. Finally, a websocket is used to update the user in the front end.</div>
  </div>

  <script src="https://d3e54v103j8qbb.cloudfront.net/js/jquery-3.5.1.min.dc5e7f18c8.js?site=62f0a9bcac1acae2293389f6" type="text/javascript" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
  <script src="/static/js/webflow.js" type="text/javascript"></script>
  <!-- [if lte IE 9]><script src="https://cdnjs.cloudflare.com/ajax/libs/placeholders/3.0.2/placeholders.min.js"></script><![endif] -->
</body>
</html>